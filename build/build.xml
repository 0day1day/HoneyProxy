<project name="HoneyProxy" default="build" basedir="../">
  
	
  <taskdef resource="net/sf/antcontrib/antlib.xml">
  	<classpath>
  		<pathelement location="${basedir}/build/ant-contrib-1.0b3.jar"/>
  	</classpath>
  </taskdef>
        	
        	
  <property name="dist"  location="dist"/>
	
  <tstamp/>
  <property name="zipfile" value="${dist}/snapshot-${DSTAMP}.zip"/>
	
  <target name="build" depends="clean">
    <mkdir dir="${dist}"/>
	<copy todir="${dist}">
      <fileset dir=".">
      	<excludesfile name=".gitignore"/>
      	<excludesfile name="build/ignore.txt"/>
      </fileset>
	</copy>
  	<!-- Workaround for the dojo build system -->
  	<copy todir="${dist}/gui/js/lib/">
  	      <fileset dir="build/dojo/">
  	      </fileset>
    </copy>
  </target>
	
  <target name="pack" depends="build" description="put it into a zip file! :)">
    <zip destfile="${zipfile}"
         basedir="${dist}"
    />
  	<!-- <move file="${dist}/snapshot.zip" todir="dir/to/move/to"/> -->
  </target>
	
  <target name="deploy-snapshot" description="deploy to github! :)">
  	<if>
  		<not><available file="${zipfile}"/></not>
  		<then>
  			<antcall target="pack" />
  		</then>
  	</if>
  	<exec dir="build/" executable="python">
  		<arg line='-u' />
  		<arg line='deploy-snapshot.py' />
  	</exec>
  </target>	
	
	

  <target name="clean" description="clean up" >
    <!-- Delete the ${dist} directory trees -->
    <delete dir="${dist}"/>
  </target>
</project>