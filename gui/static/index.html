<html>
<head>
<meta charset="utf-8" />
<title>HoneyProxy</title>
<script>
function log(msg){
	console.timeEnd(1);
	console.log("onmessage");
	//console.log(msg);
	//document.getElementById("log").innerText += msg+"\n";
	try {
	data = JSON.parse(msg);
	document.getElementById("log").innerText += data.msg+"\n";
	document.getElementById("log").innerHTML += '<img src="data:image/png;base64,'+window.btoa(data.response.content)+'">"'
	} catch(e) {}
};
var urlData = JSON.parse(decodeURIComponent(location.hash).replace("#",""));
var webSocketURL = urlData.ws;
var authKey = urlData.auth;
var ws = new WebSocket(webSocketURL);
ws.onopen = function(e){
	ws.send(JSON.stringify({action:"auth",key:authKey}));
	log("Connection etablished");};
ws.onmessage = function(e){log(/*window.atob(*/e.data/*)*/);};

//ws.send("ping");
</script>
</head>
<body>
<h3>Log</h3>
<pre id="log">
</pre>
</body>
</html>